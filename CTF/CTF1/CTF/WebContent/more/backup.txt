			/*ALWAYS BACKUP!!!!!! */
			 
			String plaintext1 = request.getParameter("user");
			String plaintext = request.getParameter("pwd");
			String query;
			String role="";
			boolean tru=false;
			
			try (BufferedReader br = new BufferedReader(new FileReader("../check.txt"))) {
			    String line1;
			    String line2;
			    int num=6;
			    int i=1000;
			    String[] a={"NSA","FBI","ABC","123","456","MD5","AES","CIA"};
			    MessageDigest m = MessageDigest.getInstance("MD5");
			    m.reset();
			    m.update(plaintext.getBytes());
			    byte[] digest = m.digest();
			    BigInteger bigInt = new BigInteger(1,digest);
			    String hashtext = bigInt.toString(16);
			    while(hashtext.length() < 32 ){
			      hashtext = "0"+hashtext;
			    }
			    m.reset();
			    m.update(plaintext1.getBytes());
			    digest = m.digest();
			    bigInt = new BigInteger(1,digest);
			    String hashtext1 = bigInt.toString(16);
			    while(hashtext1.length() < 32 ){
			      hashtext1 = "0"+hashtext1;
			    }
			    
			    while ((line1 = br.readLine()) != null&&(line2 = br.readLine()) != null) {
					if (hashtext1.equals(line1)&&hashtext.equals(line2)){
						i=arrange(i);
						out.println("<h1>WELCOME "+plaintext1+" !</h1>");
						String ua = request.getHeader( "User-Agent" );
						num=i;
						if (ua.equals(a[num])){
							out.println("Heres the flag \"xxxx\"");
							tru=true;
						}else{
							out.print("NO FLAG FOR YOU");
							tru=true;
						}
					}
						
					}
						
			    
			
				} catch (Exception e) {
				System.err.println("Error: " + e);
				}
			if(tru==false){
				out.print("<h1>Oops! Wrong password!</h1><p><a href=\"index.jsp\">Return to Civilisation</a></p>");
					
			}
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
			
/*MY SECRET FUNCTION EXTRA SECURITY*/ aW50IGFycmFuZ2UoaW50IGkpew0KLy9pdmUgYmVlbiBmb3VuZCBvaCBubw0KCQkgICAgaT0zOw0KCQkgICAgaT0oaS8yKTsNCgkJICAgIGk9aSo1LTkqLTExOw0KCQkgICAgaT1pLzIqNDsNCgkJICAgIGk9aS0yMDA7DQoJCSAgICBpPWkvMjsNCgkJCXJldHVybiBpOw0KCQl9
		
