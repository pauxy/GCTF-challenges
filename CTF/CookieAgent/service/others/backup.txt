			/*!!!!!!ALWAYS BACKUP!!!!!!*/
			 
			String plaintext1 = request.getParameter("user");
			String plaintext = request.getParameter("pwd");
			String nume = request.getParameter("num");
			int numbe=0;
			boolean numb=true;
			try{
				numbe=Integer.parseInt(nume);
			}catch(Exception e){
				numb=false;
			}
			String query;
			String role="";
			boolean tru=false;
			String loc="../check.txt";
			if(numb){
				try (BufferedReader br = new BufferedReader(new FileReader(loc))) {
				    String line1;
				    String line2;
				    int num=6;
				    int i=numbe;
				    String[] a={"NSA","FBI","ABC","123","456","currently108elements","MD5","AES","CIA","ASD","KKK","GAK","286","420","BLA","ZEI","TXX","howslife?","idunnowhattowrite","d1ff1cul+","3e25y5y0u","1337","hax0r","whatsthis??????","iwonderthelengthofthisarray","magic","magi","mag","ma","mag","magi","magic","nothing","null","true","false","secret","agent","007","nowmuchmore","probablynotthatmuch","goodluck","longarrayislong","idontknowanymore","notascomplicatedasitlooks","orisitdifficult?","OUT","LINE","AVAIL","ABL","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","IWANTZEFLAG","FLAG","FLAGISNICEFLAG?","GIVEFLAGPLEASE","IAMHERE","MAGICALLY","IAMHERE","CHOOSEME","IAMHEREEE","HEREIAM","CHOOSEEMEEE","LINE14","ARRANGEME","WHOISTHEONE?","i am","isitme?","GCTF","admin","member","SHA512","WHATAMIDOING","IS","THIS","ASECR","ET","MESSAGE","???","ORISITNOT","IDONTACTUALLY","KNOW","HOWMANYELEMENTS","INTHIS","ARRAYOF","WORDS","NICESONGS","ILIKE","BADSONGS","IDONT","AN","EYEFO","RAN","EYE","303","8262017","PM","AM","SERVER","LOCA","LH","OST","LAST","ONE","DONE"};
				    MessageDigest m = MessageDigest.getInstance("MD5");
				    m.reset();
				    m.update(plaintext.getBytes());
				    byte[] digest = m.digest();
				    BigInteger bigInt = new BigInteger(1,digest);
				    String hashtext = bigInt.toString(16);
				    while(hashtext.length() < 32 ){
				    	hashtext = "0"+hashtext;
				    }
				    m.reset();
				    m.update(plaintext1.getBytes());
				    digest = m.digest();
				    bigInt = new BigInteger(1,digest);
				    String hashtext1 = bigInt.toString(16);
				    while(hashtext1.length() < 32 ){
				    	hashtext1 = "0"+hashtext1;
				    }
				    
				    while ((line1 = br.readLine()) != null&&(line2 = br.readLine()) != null) {
						if (hashtext1.equals(line1)&&hashtext.equals(line2)){
							i=arrange(i);
							out.println("<h1>WELCOME "+plaintext1+" !</h1>");
							String ua = request.getHeader( "User-Agent" );
							num=i;
							if (ua.equals(a[num])){
								out.println("Dear authorised agent,<br>Heres the flag \"XXXXXXXXXXXXXXXXXXXXXXXXXX"\");
								tru=true;
							}else{
								out.print("YOU ARE NOT THE AGENT IM LOOKING FOR! <br>GO AWAY!");
								tru=true;
							}
						}
							
						}
							
				    
				
					} catch (Exception e) {
					System.err.println("Error: " + e);
					}
			}
			if(tru==false){
				out.print("<h1>Oops! Wrong password!</h1><p><a href=\"../index.jsp\">Return to Civilisation</a></p>");
					
			}			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
		
		
		
		
		
		
		
		
		
/*!!extra security section!!*/
aW50IGFycmFuZ2UoaW50IGkpewoJaT1pKzM7CglpPShpLzIpOwogICAgICAgIGk9aSo1LTkqLTExOwogICAgICAgIGk9aS8yKjQ7CiAgICAgICAgaT1pLTIwMDsKICAgICAgICBpPWkvMjsKICAgICAgICBpPWkrMTAwOwogICAgICAgIGk9aSUxMDA7CglpPWkrMjA7CglpZihpIT0yMCl7CgkJcmV0dXJuIGk7Cgl9Cglmb3IoaW50IGs9MDtrPDQ7aysrKXsKCQlpPWFycmFuZ2UoaSk7CiAgICAgICAgfQoJaT1pK2k7CglyZXR1cm4gaTsKfQk=